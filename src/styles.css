:root{
  --bg:#0e1117; --panel:#141925; --text:#f2f5fb; --muted:#aeb9cf; --accent:#4aa3ff;
  --ok:#28c990; --warn:#f5a524; --danger:#ef5b5b; --line:#273044; --slot:#111726;
  --control:#1a2030; --tab:#1a2435;
  --gap:18px; --radius:14px; --cell:clamp(54px,4.8vh,70px);
  --scale:1;
  --f-base:clamp(14px,1.2vw,20px); --f-lg-base:clamp(18px,1.8vw,28px); --f-xl-base:clamp(24px,2.4vw,36px);
  --f:calc(var(--f-base)*var(--scale)); --f-lg:calc(var(--f-lg-base)*var(--scale)); --f-xl:calc(var(--f-xl-base)*var(--scale));

  --elev-1: 0 2px 8px rgba(0,0,0,.25);
  --elev-2: 0 6px 20px rgba(0,0,0,.35);

  --text-high: #fff;
  --text-med: #C8D2E0;
  --text-muted: #9aa8be;

  --accent-home: #4CC9F0;
  --accent-travel: #F72585;
  --accent-flex: #B8F35B;
  --accent-charge: #FFB703;
  --accent-triage: #06D6A0;
  --accent-other: #A29BFE;

  --right-sidebar-w:clamp(260px,300px,420px);

  /* no color-mix: simple halo */
  --halo: 0 0 0 1px currentColor inset, 0 0 18px rgba(0,0,0,.18);

  --z-base: 1;
  --z-sticky: 100;
  --z-dropdown: 500;
  --z-modal: 1000;
  --z-toast: 1100;
  --z-drag: 1200;

  --zone-fg: #f2f5fb;
  --card-border: rgba(0,0,0,.08);
  --shadow: 0 1px 2px rgba(0,0,0,.06), 0 8px 24px rgba(0,0,0,.06);
  --ring: rgba(0,120,212,.45);

  /* dark palette */
  --zone-bg-1:#3b82f6; --zone-bg-2:#2563eb; --zone-bg-3:#1d4ed8;
  --zone-bg-4:#ef4444; --zone-bg-5:#b91c1c;
  --zone-bg-6:#10b981; --zone-bg-7:#047857; --zone-bg-8:#8b5cf6;

  /* nurse tones harmonized with zone colors */
  --nurse-bg-1:#60a5fa; --nurse-bg-2:#3b82f6; --nurse-bg-3:#2563eb;
  --nurse-bg-4:#f87171; --nurse-bg-5:#ef4444;
  --nurse-bg-6:#34d399; --nurse-bg-7:#10b981; --nurse-bg-8:#a78bfa;
}

:root[data-theme='light']{
  --bg:#f7f9fc;
  --panel:#ffffff;
  --control:#f0f2f7;
  --tab:#e2e6ef;
  --line:#c5d0e1;
  --text-high:#1A2233;
  --text-med:#2C3A52;
  --text-muted:#54627A;
  --elev-1: 0 2px 8px rgba(0,0,0,.08);
  --elev-2: 0 6px 20px rgba(0,0,0,.12);

  --zone-fg: #0a0a0a;
  /* light palette */
  --zone-bg-1:#dbeafe; --zone-bg-2:#bfdbfe; --zone-bg-3:#93c5fd;
  --zone-bg-4:#fee2e2; --zone-bg-5:#fecaca;
  --zone-bg-6:#d1fae5; --zone-bg-7:#a7f3d0; --zone-bg-8:#ede9fe;

  /* nurse tones for light theme */
  --nurse-bg-1:#bfdbfe; --nurse-bg-2:#93c5fd; --nurse-bg-3:#60a5fa;
  --nurse-bg-4:#fecaca; --nurse-bg-5:#fca5a5;
  --nurse-bg-6:#a7f3d0; --nurse-bg-7:#6ee7b7; --nurse-bg-8:#ddd6fe;
}

:root[data-contrast='high']{
  --line: var(--text-high);
  --text-muted: var(--text-med);
}

*{box-sizing:border-box}
html,body{height:100%;overflow:auto}
body{margin:0;background:var(--bg);color:var(--text-high);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
.wrap{width:100%;padding:var(--gap)}
header{display:grid;grid-template-columns:1fr auto auto;gap:var(--gap);align-items:center;margin-bottom:var(--gap);position:sticky;top:0;z-index:var(--z-sticky)}
.title{font-size:var(--f-xl);font-weight:800;letter-spacing:.2px}
.subtitle{color:var(--text-muted);font-size:var(--f)}
.time-block{text-align:right}
.clock-big{font-size:var(--f-xl);font-weight:700;line-height:1}
.date-small{font-size:var(--f);color:var(--text-muted)}
.actions{display:flex;gap:var(--gap);align-items:center}

/* choose the variable-based sidebar width */
.layout{display:grid;grid-template-columns:1fr var(--right-sidebar-w);gap:var(--gap)}
.layout[data-testid="main-board"]{
  min-height:100vh;
  overflow:auto;
  background:var(--panel);
}
.layout[data-testid="main-board"] .col{
  height:auto;
  overflow:visible;
}
.builder-layout{grid-template-columns:minmax(200px,25%) 1fr}

.panel{background:var(--panel);color:var(--text-high);border:1px solid var(--line);border-radius:var(--radius);padding:12px 14px;box-shadow:var(--elev-1);display:flex;flex-direction:column;min-height:0}
.panel h3{color:var(--text-high);font-size:clamp(14px,.95vw,16px)}
.panel .muted{color:var(--text-muted)}
.col{display:flex;flex-direction:column;gap:var(--gap);height:100%;min-height:0;overflow:hidden}
/* merged resolution */
.col>.panel{flex:0 0 auto}
#incoming-panel,#offgoing-panel{flex:1}
.zones-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:clamp(8px,1.5vw,12px);max-width:1520px;margin:0 auto;flex:1;grid-auto-rows:auto}

@media (max-width:900px){
  .layout{grid-template-columns:1fr}
  .zones-grid{grid-template-columns:1fr}
}

/* no color-mix: gradient overlay + control */
.widget{
  background:
    linear-gradient(0deg, rgba(0,0,0,.04), rgba(0,0,0,.04)),
    var(--control);
  border:1px dashed var(--line);
  border-radius:12px;
  padding:8px 10px;
  margin-top:8px
}
.widget .title{font-weight:600;color:var(--text-high);display:flex;align-items:center;gap:6px}
.widget .sub{color:var(--text-med);font-size:.85em}

.form-row{margin:8px 0}
.form-grid{display:grid;grid-template-columns:repeat(3,minmax(200px,1fr));gap:10px}
.btn-row{display:flex;gap:8px;margin-top:8px}
.input,input,select,textarea{background:var(--control);color:var(--text-high);border:1px solid var(--line);border-radius:8px;padding:6px 8px}
.panel textarea{flex:1}
.btn{background:var(--tab);border:1px solid var(--line);border-radius:8px;padding:6px 10px;cursor:pointer}
.muted{color:var(--text-muted)}
.single-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.board-actions{display:flex;justify-content:flex-end;margin-bottom:8px}

.assignments{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
.assignment-card{background:var(--control);border:1px solid var(--line);border-radius:14px;padding:10px 12px;min-height:84px;box-shadow:var(--elev-1)}

/* no color-mix: overlay + control */
.nurse-pill{
  position:relative;display:flex;align-items:center;gap:8px;
  padding:6px 10px;border-radius:999px;
  background:
    linear-gradient(0deg, rgba(0,0,0,.08), rgba(0,0,0,.08)),
    var(--control);
  border:1px solid var(--line);color:var(--text-high)
}
.nurse-pill[data-type="home"]{--pill:var(--accent-home)}
.nurse-pill[data-type="travel"]{--pill:var(--accent-travel)}
.nurse-pill[data-type="flex"]{--pill:var(--accent-flex)}
.nurse-pill[data-type="charge"]{--pill:var(--accent-charge)}
.nurse-pill[data-type="triage"]{--pill:var(--accent-triage)}
.nurse-pill[data-type="other"]{--pill:var(--accent-other)}
.nurse-pill::before{content:"";position:absolute;inset:0;border-radius:inherit;box-shadow:0 0 0 2px var(--pill) inset,var(--halo);opacity:.75;pointer-events:none}
.nurse-name{font-weight:600}
.nurse-meta{color:var(--text-med);font-size:.85em}
.chips{margin-left:auto;display:flex;gap:6px}
.chip{display:inline-flex;align-items:center;gap:4px;padding:2px 6px;border-radius:999px;background:rgba(255,255,255,.06);color:var(--text-med);border:1px solid var(--line);font-size:.75em;line-height:1}
.chip .icon{font-size:1em}

/* no color-mix: simple currentColor outline */
.nurse-pill:focus-visible,.chip:focus-visible{outline:2px solid currentColor;outline-offset:2px}

@media print{
  #widgets,.widget{display:none!important}
.zone-card,.nurse-card{background:var(--panel)!important;color:var(--text-high)!important;box-shadow:none!important}
}

.overlay,.backdrop,.modal-backdrop{position:fixed;inset:0;z-index:var(--z-modal)}
.overlay:not(.open),.backdrop:not(.open),.modal-backdrop:not(.open){pointer-events:none;opacity:0}
.backdrop{background:rgba(0,0,0,.6);transition:opacity .2s}

.offcanvas{position:fixed;top:0;right:0;bottom:0;width:300px;background:var(--panel);transform:translateX(100%);pointer-events:none;transition:transform .3s;z-index:var(--z-modal)}
.offcanvas.open{transform:translateX(0);pointer-events:auto}
@media (prefers-reduced-motion: reduce){.offcanvas{transition:none}}

.drag-layer{position:fixed;inset:0;pointer-events:none;z-index:var(--z-drag)}

.dropdown{position:absolute;z-index:var(--z-dropdown)}
.toast{position:fixed;z-index:var(--z-toast)}

.draft-layout{display:grid;grid-template-columns:320px 1fr 320px;gap:12px;height:100%}
.draft-layout .panel{display:flex;flex-direction:column}
.roster-panel{overflow:hidden}

.settings-grid{display:grid;grid-template-columns:minmax(320px,420px) 1fr;gap:16px}
.roster-box{max-height:60vh;overflow-y:auto}
.roster-row{display:flex;align-items:center;justify-content:space-between;padding:4px;cursor:pointer}
.roster-row.selected{background:var(--tab)}
.settings-pane{display:flex;flex-direction:column;gap:16px}
.zone-card{border:1px solid var(--line);border-radius:8px;padding:6px;background:var(--panel)}
.zone-card h4{margin:0 0 4px}
.roster-controls{display:flex;flex-direction:column;gap:6px}
#roster-list{list-style:none;padding:0;margin:8px 0;flex:1;overflow:auto}
#roster-list li{padding:4px 6px;border-radius:6px;cursor:grab}
#roster-list li.selected{background:var(--control)}
.board-panel{overflow:auto}
.zone{margin-bottom:8px}
.zone h4{display:flex;justify-content:space-between;align-items:center;margin:0}
.zone .slots{min-height:40px;border:1px dashed var(--line);padding:4px;border-radius:8px}
.slot{padding:4px 6px;margin:2px 0;background:var(--control);border-radius:6px;cursor:grab}
.flags-panel ul{list-style:none;padding:0;margin:0;flex:1;overflow:auto}
.flags-panel li{padding:4px 0}

.manage-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:var(--z-modal)}
.manage-dialog{background:var(--panel);padding:16px;border-radius:8px;display:flex;flex-direction:column;gap:8px;min-width:260px}
.manage-dialog label{display:flex;flex-direction:column;gap:4px}
.manage-dialog .dialog-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:8px}
.banner{background:var(--danger);color:var(--text);padding:8px;text-align:center}

.preset-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:8px;margin:8px 0}
.preset-card{display:flex;flex-direction:column;gap:4px;border:1px solid var(--line);border-radius:8px;padding:6px;background:var(--control)}
.swatches{display:flex;gap:4px}
.swatch{flex:1;height:12px;border-radius:4px}
.preset-meta{display:flex;flex-direction:column;font-size:.85em}
